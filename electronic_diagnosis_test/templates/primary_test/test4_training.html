{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="container">
    <div class="text-center">
        <h2 class="text-lg-purple fs-2 mb-5" style="color: #5E2B8C;">الاختبار الفرعي الأول</h2>
        <h4 class=" mb-5 fs-3" style="color: #fd7e14;">دقة قراءة الكلمة المفردة - الفقرات التدريبية</h4>
    </div>
    
    <div class="card rounded-card my-3 mx-auto">
        <div class="container  mt-4" style="direction: rtl;">
            <form method="post" action="{% url 'test4_training' %}">
                {% csrf_token %}
                {% if error %}
    <div class="alert alert-danger text-center fw-bold" role="alert">
        {{ error }}
    </div>
{% endif %}
                <div class="row mt-4 mx-auto text-center w-100">
                    
                    <!-- Column 1 (1–3) -->
                    <div class="">
                          
                        <table class="custom-reading-table">
                            <thead>
                                <tr>
                                    <th >م</th>
                                    <th >الكلمة</th>
                                    <th >✓</th>
                                </tr>
                            </thead>
                            <tbody >
                                {% for word in training_words %}
                                <tr>
                                    <td class="cell-number">{{ forloop.counter }}</td>
                                    <td class="cell-word position-relative text-center">
                                        <button class="position-absolute end-0 top-50 translate-middle-y">
                                            <i class="bi bi-volume-up fs-3"></i>
                                        </button>
                                        {{ word.text }}
                                        </td>
                                    <td id="cell_{{ forloop.counter0}}" class="score-cell unresponsive" onclick="toggleCorrect({{ forloop.counter0 }})">
                                        <span id="mark_{{ forloop.counter0 }}">-</span>
                                        <input type="hidden" name="train_{{ forloop.counter0 }}" id="input_{{ forloop.counter0 }}" value="-">
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>


                <div class="col-12 mt-4">

                
                    <!-- Submit Button BELOW -->
                    <div class="d-grid mx-auto mt-5 mb-4" style="width: fit-content;">
                        <input id="end" type="submit" name="form1" class="btn-light-purple px-5 py-3 fs-5"
                        value="تسليم الاختبار" data-bs-toggle="modal" data-bs-target="#ModalSubmit"
                        style="background-color: #b48ce6; color: black; font-weight: bold;">
                    </div>
                
                </div>
                

                
                
              </form>
        </div>
    </div>
</div>


<script>

    function toggleCorrect(index) {
    const cell = document.getElementById("cell_" + index);
    const input = document.getElementById("input_" + index);
    const mark = document.getElementById("mark_" + index);

    // Clear all states
    cell.classList.remove("unresponsive", "correct", "incorrect");

    if (input.value === "-") {
        input.value = "1";
        mark.innerText = "✓";
        cell.classList.add("correct");
    } else if (input.value === "1") {
        input.value = "0";
        mark.innerText = "✗";
        cell.classList.add("incorrect");
    } else {
        input.value = "-";
        mark.innerText = "-";
        cell.classList.add("unresponsive");
    }

    updateTotalScore();
}

</script>


{% endblock %}
